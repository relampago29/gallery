(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[235],{388:(e,t,r)=>{"use strict";r.d(t,{N_:()=>l,a8:()=>n});var a=r(981);let s=(0,r(9984).A)({locales:["pt","en"],defaultLocale:"pt",localePrefix:"always"}),{Link:l,usePathname:n,useRouter:i,redirect:o,getPathname:c}=(0,a.A)(s)},1451:()=>{},1467:(e,t,r)=>{Promise.resolve().then(r.bind(r,6160)),Promise.resolve().then(r.bind(r,3798)),Promise.resolve().then(r.bind(r,6635))},2289:(e,t,r)=>{"use strict";r.d(t,{Dv:()=>i,FC:()=>h,Gu:()=>n,UM:()=>o,XC:()=>u,fB:()=>c});var a=r(8214),s=r(5317),l=r(858);function n(e){let t=e.sizes||{},r=t["960"]||t["800"]||t["640"]||Object.values(t)[0];return(null==r?void 0:r.jpg)?{src:r.jpg,w:r.width,h:r.height}:{}}async function i(e){let{limitN:t,categoryId:r,cursor:l,forceApi:n}=e;try{var i;let e=new URLSearchParams;e.set("limit",String(t)),r&&e.set("categoryId",r),null!=l&&e.set("cursor",String(l));let a=await fetch("/api/public-photos/list?".concat(e.toString()),{cache:"no-store"});if(!a.ok)throw Error(await a.text());let s=await a.json();return{items:s.items||[],nextCursor:null!=(i=s.nextCursor)?i:null}}catch(e){if(n)throw Error((null==e?void 0:e.message)?String(e.message):String(e))}let o=[(0,s._M)("published","==",!0),(0,s.My)("createdAt","desc"),(0,s.AB)(t)];r&&o.unshift((0,s._M)("categoryId","==",r)),null!=l&&o.push((0,s.HM)(l));let c=(await (0,s.GG)((0,s.P)((0,s.rJ)(a.db,"public_photos"),...o))).docs.map(e=>({id:e.id,...e.data()})),d=c.length?c[c.length-1].createdAt:null;return{items:c,nextCursor:d}}async function o(e){let t=(e.file.name.split(".").pop()||"jpg").toLowerCase(),r="undefined"!=typeof crypto&&"randomUUID"in crypto?crypto.randomUUID():String(Date.now()),n="masters/public/".concat(r,".").concat(t),i=(0,l.bp)((0,l.KR)(a.I,n),e.file,{contentType:e.file.type});await new Promise((e,t)=>{i.on("state_changed",void 0,t,()=>e())});let o=Date.now();try{let t=await fetch("/api/public-photos/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:e.title||null,alt:e.alt||e.title||null,categoryId:e.categoryId,createdAt:o,masterPath:n})});if(!t.ok)throw Error(await t.text())}catch(t){await (0,s.gS)((0,s.rJ)(a.db,"public_photos"),{title:e.title||null,alt:e.alt||e.title||null,categoryId:e.categoryId,createdAt:o,published:!1,status:"processing",masterPath:n})}return{photoId:r,masterPath:n,createdAt:o}}async function c(e){let t=await fetch("/api/public-photos/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({photoId:e})});if(!t.ok)throw Error(await t.text())}function d(e){return e.trim().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")}async function h(e){let{file:t,sessionId:r}=e,s=d(r)||d(t.name.split(".")[0]||"sessao"),n=(t.name.split(".").pop()||"jpg").toLowerCase(),i="undefined"!=typeof crypto&&"randomUUID"in crypto?crypto.randomUUID():String(Date.now()),o="masters/sessions/".concat(s,"/").concat(i,".").concat(n),c=(0,l.bp)((0,l.KR)(a.I,o),t,{contentType:t.type});return await new Promise((e,t)=>{c.on("state_changed",void 0,t,()=>e())}),{photoId:i,masterPath:o,createdAt:Date.now(),sessionId:s}}async function u(e){var t,r,a,s;let l=await fetch("/api/session-photos/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:e.sessionId,masterPath:e.masterPath,title:null!=(t=e.title)?t:null,alt:null!=(a=null!=(r=e.alt)?r:e.title)?a:null,createdAt:null!=(s=e.createdAt)?s:Date.now()})});if(!l.ok)throw Error(await l.text());return l.json().catch(()=>({}))}},3798:(e,t,r)=>{"use strict";r.d(t,{PublicGallery:()=>i});var a=r(5155),s=r(2115),l=r(2289);function n(e){if(!e)return"";try{return new Intl.DateTimeFormat("pt-PT",{day:"2-digit",month:"short",year:"numeric"}).format(new Date(e))}catch(e){return""}}function i(){let[e,t]=(0,s.useState)([]),[r,i]=(0,s.useState)(!0),[o,c]=(0,s.useState)(null),[d,h]=(0,s.useState)(null),u=(0,s.useMemo)(()=>e.find(e=>e.id===d)||null,[e,d]);if((0,s.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/public-photos/list?limit=48",{cache:"no-store"});if(!e.ok)throw Error(await e.text());let r=await e.json(),a=Array.isArray(r.items)?r.items:[];t(a.filter(e=>!1!==e.published))}catch(e){c((null==e?void 0:e.message)||"Falha ao carregar o portf\xc3\xb3lio. Tenta novamente em instantes."),t([])}finally{i(!1)}})()},[]),(0,s.useEffect)(()=>{if(!u)return;let e=e=>{"Escape"===e.key&&h(null)},t=document.body.style.overflow;return document.body.style.overflow="hidden",window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e),document.body.style.overflow=t}},[u]),r)return(0,a.jsx)("div",{className:"py-16 text-center text-sm text-white/70",children:"A preparar as imagens\xe2€\xa6"});if(o)return(0,a.jsx)("div",{className:"rounded-3xl border border-red-400/40 bg-red-500/10 p-6 text-sm text-red-100",children:o.includes("index")?"Precisamos de publicar o \xc3\xadndice do Firestore para concluir esta sec\xc3\xa7\xc3\xa3o.":o});if(0===e.length)return(0,a.jsx)("div",{className:"py-16 text-center text-sm text-white/70",children:"Ainda n\xc3\xa3o h\xc3\xa1 hist\xc3\xb3rias p\xc3\xbablicas aqui \xe2€” volta em breve."});let p=e.map(e=>{var t;let r=(0,l.Gu)(e),s=()=>{r.src&&h(e.id)};return(0,a.jsxs)("article",{className:"group overflow-hidden rounded-3xl border border-white/10 bg-white/5 shadow-[0_20px_80px_rgba(0,0,0,0.45)] backdrop-blur-md transition hover:border-white/30",role:r.src?"button":void 0,tabIndex:r.src?0:void 0,onClick:r.src?s:void 0,onKeyDown:r.src?e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),s())}:void 0,children:[(0,a.jsxs)("div",{className:"relative aspect-[4/3] bg-white/5",children:[r.src?(0,a.jsx)("img",{src:r.src,alt:e.alt||e.title||"Portf\xc3\xb3lio",className:"h-full w-full object-cover transition duration-700 group-hover:scale-105",loading:"lazy"}):(0,a.jsx)("div",{className:"flex h-full items-center justify-center text-xs text-white/60",children:"processing"===e.status?"A gerar variantes\xe2€\xa6":"Sem preview"}),(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 transition group-hover:opacity-100"})]}),(0,a.jsxs)("div",{className:"space-y-2 px-5 py-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white truncate",children:e.title||"(sem t\xc3\xadtulo)"}),(0,a.jsx)("p",{className:"text-sm text-white/70 truncate",children:e.alt||"Hist\xc3\xb3ria captada recentemente"}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-white/50 uppercase tracking-wide",children:[(0,a.jsx)("span",{children:n(e.createdAt)}),e.categoryId?(0,a.jsx)("span",{className:"rounded-full border border-white/20 px-2 py-0.5 text-[10px] tracking-wider",children:e.categoryId}):null]}),(null==(t=e.lqip)?void 0:t.blurDataURL)&&(0,a.jsx)("div",{className:"text-[10px] text-white/40",children:"processing"===e.status?"A processar":"Publicado"})]})]},e.id)}),m=u?(0,l.Gu)(u):null;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"grid gap-6 sm:grid-cols-2 lg:grid-cols-3",children:p}),u&&(null==m?void 0:m.src)&&(0,a.jsx)("div",{role:"dialog","aria-modal":"true",className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4",onClick:()=>h(null),children:(0,a.jsxs)("div",{className:"relative w-full max-w-4xl space-y-4 rounded-3xl bg-black/40 p-4 text-white shadow-2xl backdrop-blur",onClick:e=>e.stopPropagation(),children:[(0,a.jsx)("button",{type:"button",className:"absolute right-4 top-4 rounded-full border border-white/30 px-3 py-1 text-sm text-white/80 transition hover:border-white/70 hover:text-white",onClick:()=>h(null),children:"Fechar"}),(0,a.jsx)("img",{src:m.src,alt:u.alt||u.title||"Portf\xc3\xb3lio",className:"max-h-[80vh] w-full rounded-2xl object-contain"}),(0,a.jsxs)("div",{className:"space-y-1 px-1",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold",children:u.title||"(sem t\xc3\xadtulo)"}),(0,a.jsx)("p",{className:"text-sm text-white/70",children:u.alt||"Hist\xc3\xb3ria captada recentemente"}),(0,a.jsx)("div",{className:"text-xs uppercase tracking-wide text-white/50",children:n(u.createdAt)})]})]})})]})}},6635:(e,t,r)=>{"use strict";r.d(t,{default:()=>u});var a=r(5155),s=r(2115),l=r(7652),n=r(2797),i=r(388),o=r(5695),c=r(6203),d=r(8214);let h={src:"/_next/static/media/logo-sem-fundo-sem-nome.99a8cde6.png"};r(1451);let u=()=>{let e=(0,l.c3)("navbar"),t=(0,n.Ym)(),r=(0,i.a8)(),u=(0,o.useSearchParams)(),p=(0,o.useRouter)(),[m,x]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e=(0,c.hg)(d.j,e=>x(e));return()=>e()},[]);let w=s.useMemo(()=>{let e=null==u?void 0:u.toString();return e?"".concat(r,"?").concat(e):r},[r,u]),b=async()=>{try{await (0,c.CI)(d.j),p.push("/"),p.refresh()}catch(e){console.error("Falha ao terminar sess\xe3o",e)}};return(0,a.jsxs)("div",{className:"navbar bg-base-100",children:[(0,a.jsxs)("div",{className:"navbar-start",children:[(0,a.jsxs)("div",{className:"dropdown",children:[(0,a.jsx)("div",{tabIndex:0,role:"button",className:"btn btn-ghost lg:hidden",children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h8m-8 6h16"})})}),(0,a.jsxs)("ul",{tabIndex:0,className:"menu menu-sm dropdown-content bg-base-100 rounded-box z-10 mt-3 w-52 p-2 shadow",children:[(0,a.jsx)("li",{children:(0,a.jsx)("a",{children:"Portof\xf3lio"})}),(0,a.jsxs)("li",{children:[(0,a.jsx)("a",{children:"Parent"}),(0,a.jsxs)("ul",{className:"p-2",children:[(0,a.jsx)("li",{children:(0,a.jsx)("a",{href:"/admi.tsx"})}),(0,a.jsx)("li",{children:(0,a.jsx)("a",{children:"Submenu 2"})})]})]}),(0,a.jsx)("li",{children:(0,a.jsx)("a",{children:"Item 3"})})]})]}),(0,a.jsx)("img",{src:h.src,alt:"logo",className:"w-10 h-8"}),(0,a.jsx)("a",{className:"text-xl pl-2 pt-1",children:"Momentos"})]}),(0,a.jsx)("div",{className:"navbar-center hidden lg:flex",children:(0,a.jsxs)("ul",{className:"menu menu-horizontal px-1",children:[(0,a.jsx)("li",{children:(0,a.jsx)(i.N_,{href:"/portofolio"===r?"/":"/portofolio",children:e("/portofolio"===r?"home":"portfolio")})}),(0,a.jsx)("li",{children:(0,a.jsx)("a",{children:e("about")})}),(0,a.jsx)("li",{children:(0,a.jsx)("a",{children:e("contact")})}),m&&(0,a.jsx)("li",{children:(0,a.jsx)(i.N_,{href:"/admin",children:"Admin"})})]})}),(0,a.jsxs)("div",{className:"navbar-end",children:[m&&(0,a.jsx)("button",{type:"button",onClick:b,className:"btn btn-ghost mr-2 text-sm",children:e("logout")}),(0,a.jsxs)("div",{className:"dropdown dropdown-end",children:[(0,a.jsxs)("div",{tabIndex:0,role:"button",className:"btn btn-ghost",children:[t.toUpperCase(),(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 ml-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.08 1.04l-4.25 4.25a.75.75 0 01-1.08 0L5.21 8.27a.75.75 0 01.02-1.06z",clipRule:"evenodd"})})]}),(0,a.jsxs)("ul",{tabIndex:0,className:"menu menu-sm dropdown-content bg-base-100 rounded-box z-10 mt-2 w-28 p-2 shadow",children:[(0,a.jsx)("li",{children:(0,a.jsx)(i.N_,{href:w,locale:"pt",className:"pt"===t?"active":void 0,"aria-current":"pt"===t?"page":void 0,children:"PT"})}),(0,a.jsx)("li",{children:(0,a.jsx)(i.N_,{href:w,locale:"en",className:"en"===t?"active":void 0,"aria-current":"en"===t?"page":void 0,children:"EN"})})]})]})]})]})}},7652:(e,t,r)=>{"use strict";r.d(t,{c3:()=>l});var a=r(2797);function s(e,t){return(...e)=>{try{return t(...e)}catch{throw Error(void 0)}}}let l=s(0,a.c3);s(0,a.kc)},8214:(e,t,r)=>{"use strict";r.d(t,{I:()=>h,db:()=>d,j:()=>c});var a=r(3915),s=r(6203),l=r(5317),n=r(858),i=r(9509);let o=(0,a.Dk)().length?(0,a.Dk)()[0]:(0,a.Wp)({apiKey:"AIzaSyA8JlKiOAm4_8J7P77ZejpRbfm0liK1Gmk",authDomain:"gallery-e87e5.firebaseapp.com",projectId:"gallery-e87e5",storageBucket:"gallery-e87e5.firebasestorage.app",messagingSenderId:"799027183409",appId:"1:799027183409:web:24c7d316a8a523e7b7fa10",measurementId:"G-9WQWR0RHC6"}),c=(0,s.xI)(o),d=(0,l.aU)(o),h=(0,n.c7)(o);if("true"===i.env.NEXT_PUBLIC_FIREBASE_EMULATORS)try{(0,n.nb)(h,"localhost",9199)}catch(e){}}},e=>{e.O(0,[50,992,811,288,797,55,441,964,358],()=>e(e.s=1467)),_N_E=e.O()}]);